# Data Model Documentation

## Overview Data Model

Sistem menggunakan format JSON untuk representasi data yang fleksibel dan mudah dibaca. Data model dirancang untuk menangani semua aspek penjadwalan mata kuliah dengan struktur yang normalized dan extensible.

## Struktur Dataset

### Schema Utama

```json
{
  "dosen": [...],
  "matakuliah": [...],
  "ruangan": [...],
  "slot_waktu": [...]
}
```

---

## Entity Definitions

### 1. Dosen (Lecturers)

**Fungsi**: Representasi data pengajar/dosen
**Relasi**: One-to-Many dengan mata kuliah

```json
{
  "id": number,              // Unique identifier
  "nama": string,            // Nama lengkap dosen
  "bidang_keahlian": string, // Area expertise
  "email": string            // Contact email
}
```

#### Contoh Data
```json
{
  "id": 1,
  "nama": "Dr. Andi Wijaya",
  "bidang_keahlian": "Kecerdasan Buatan",
  "email": "andi.wijaya@example.com"
}
```

#### Validation Rules
- `id`: Integer positif, unique
- `nama`: String tidak kosong, 2-100 karakter
- `bidang_keahlian`: String tidak kosong
- `email`: Format email valid

#### Business Rules
- Satu dosen dapat mengajar multiple mata kuliah
- Dosen tidak boleh mengajar di waktu yang bersamaan
- Setiap mata kuliah harus memiliki dosen yang valid

### 2. Mata Kuliah (Courses)

**Fungsi**: Representasi mata kuliah yang akan dijadwalkan
**Relasi**: Many-to-One dengan dosen, One-to-Many dengan sesi

```json
{
  "id": number,              // Unique identifier
  "nama": string,            // Nama mata kuliah
  "semester": number,        // Semester (1-8)
  "sks": number,             // Satuan Kredit Semester (2 atau 3)
  "dosen_id": number,        // Foreign key ke dosen
  "jumlah_mahasiswa": number // Jumlah mahasiswa terdaftar
}
```

#### Contoh Data
```json
{
  "id": 1,
  "nama": "Pengantar Teknologi Informasi",
  "semester": 1,
  "sks": 2,
  "dosen_id": 1,
  "jumlah_mahasiswa": 35
}
```

#### Validation Rules
- `id`: Integer positif, unique
- `nama`: String tidak kosong, 5-100 karakter
- `semester`: Integer 1-8
- `sks`: Integer 2 atau 3
- `dosen_id`: Harus exist di tabel dosen
- `jumlah_mahasiswa`: Integer positif

#### Business Rules
- SKS menentukan durasi kuliah:
  - 2 SKS = 90 menit (1.5 jam)
  - 3 SKS = 135 menit (2.25 jam)
- Jumlah mahasiswa tidak boleh melebihi kapasitas ruangan
- Mata kuliah semester yang sama diprioritaskan untuk tidak bentrok

### 3. Ruangan (Rooms)

**Fungsi**: Representasi ruang kuliah yang tersedia
**Relasi**: One-to-Many dengan jadwal

```json
{
  "id": number,     // Unique identifier
  "nama": string,   // Nama ruangan
  "kapasitas": number // Kapasitas maksimal mahasiswa
}
```

#### Contoh Data
```json
{
  "id": 1,
  "nama": "Ruang A1",
  "kapasitas": 32
}
```

#### Validation Rules
- `id`: Integer positif, unique
- `nama`: String tidak kosong, 2-50 karakter
- `kapasitas`: Integer positif, biasanya 20-100

#### Business Rules
- Kapasitas ruangan harus >= jumlah mahasiswa mata kuliah
- Satu ruangan hanya dapat digunakan satu mata kuliah per waktu
- Tipe ruangan dapat berbeda (kelas, lab, auditorium)

### 4. Slot Waktu (Time Slots)

**Fungsi**: Definisi waktu tersedia untuk kuliah
**Relasi**: Template untuk generating jadwal

```json
{
  "hari": string,      // Nama hari (Senin-Minggu)
  "jam_mulai": string, // Format "HH:MM"
  "jam_selesai": string // Format "HH:MM"
}
```

#### Contoh Data
```json
{
  "hari": "Senin",
  "jam_mulai": "08:00",
  "jam_selesai": "14:00"
}
```

#### Validation Rules
- `hari`: Enum ["Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu", "Minggu"]
- `jam_mulai`: Format "HH:MM", valid time
- `jam_selesai`: Format "HH:MM", > jam_mulai

#### Business Rules
- Sistem menggunakan interval 15 menit untuk penjadwalan
- Kuliah dapat dimulai setiap kelipatan 15 menit
- Durasi minimum slot adalah 90 menit (2 SKS)

---

## Generated Data Structures

### 1. Schedule Entry

**Fungsi**: Representasi satu sesi kuliah yang terjadwal
**Generated by**: Algoritma penjadwalan

```json
{
  "matakuliah_id": number,
  "matakuliah_nama": string,
  "dosen_id": number,
  "dosen_nama": string,
  "ruangan_id": number,
  "ruangan_nama": string,
  "hari": string,
  "jam_mulai": string,
  "jam_selesai": string,
  "durasi_menit": number,
  "jumlah_mahasiswa": number,
  "semester": number
}
```

### 2. Statistics Object

**Fungsi**: Statistik performa algoritma
**Generated by**: Method calculate_stats()

```json
{
  "total_slots_attempted": number,
  "scheduled_slots": number,
  "conflicts": number,
  "execution_time": float,
  "success_rate": float,
  "failed_details": [...]
}
```

### 3. Algorithm Results

**Fungsi**: Hasil lengkap dari eksekusi algoritma
**Generated by**: Method solve()

```json
{
  "schedule": [...],  // Array of schedule entries
  "stats": {...}      // Statistics object
}
```

---

## Data Relationships

### Entity Relationship Diagram

```
┌─────────────┐     1     ∞ ┌─────────────────┐
│    Dosen    │──────────────│   Mata Kuliah   │
│             │              │                 │
│ • id        │              │ • id            │
│ • nama      │              │ • nama          │
│ • email     │              │ • semester      │
│ • keahlian  │              │ • sks           │
└─────────────┘              │ • dosen_id      │
                              │ • jml_mahasiswa │
                              └─────────────────┘
                                       │
                                       │ ∞
                                       │
                              ┌─────────────────┐
                              │     Jadwal      │
                              │                 │
                              │ • matakuliah_id │
                              │ • ruangan_id    │
                              │ • hari          │
                              │ • jam_mulai     │
                              │ • jam_selesai   │
                              └─────────────────┘
                                       │
                                       │ ∞
                                       │
┌─────────────┐     1                  │
│   Ruangan   │────────────────────────┘
│             │
│ • id        │
│ • nama      │
│ • kapasitas │
└─────────────┘
```

### Constraint Matrix

| Constraint Type | Entities Involved | Description |
|-----------------|-------------------|-------------|
| **Capacity** | Mata Kuliah ↔ Ruangan | jumlah_mahasiswa ≤ kapasitas |
| **Time Conflict** | Dosen ↔ Jadwal | Satu dosen per time slot |
| **Room Conflict** | Ruangan ↔ Jadwal | Satu ruangan per time slot |
| **Duration** | Mata Kuliah ↔ Slot Waktu | Durasi SKS fit dalam slot |

---

## Data Validation

### Input Validation

```python
def validate_dataset(data):
    """Comprehensive dataset validation"""
    errors = []
    
    # Validate dosen
    dosen_ids = set()
    for dosen in data.get('dosen', []):
        if not validate_dosen(dosen):
            errors.append(f"Invalid dosen: {dosen}")
        dosen_ids.add(dosen['id'])
    
    # Validate mata kuliah
    for mk in data.get('matakuliah', []):
        if not validate_matakuliah(mk, dosen_ids):
            errors.append(f"Invalid mata kuliah: {mk}")
    
    # Validate ruangan
    for ruangan in data.get('ruangan', []):
        if not validate_ruangan(ruangan):
            errors.append(f"Invalid ruangan: {ruangan}")
    
    # Validate slot waktu
    for slot in data.get('slot_waktu', []):
        if not validate_slot_waktu(slot):
            errors.append(f"Invalid slot waktu: {slot}")
    
    return errors
```

### Business Rule Validation

```python
def validate_business_rules(data):
    """Validate business constraints"""
    warnings = []
    
    # Check capacity constraints
    for mk in data['matakuliah']:
        suitable_rooms = [r for r in data['ruangan'] 
                         if r['kapasitas'] >= mk['jumlah_mahasiswa']]
        if not suitable_rooms:
            warnings.append(f"No suitable room for {mk['nama']}")
    
    # Check time availability
    total_duration_needed = sum(sks_to_minutes(mk['sks']) 
                               for mk in data['matakuliah'])
    total_time_available = calculate_total_available_time(data['slot_waktu'])
    
    if total_duration_needed > total_time_available:
        warnings.append("Insufficient time slots for all courses")
    
    return warnings
```

---

## Data Transformation

### Time Conversion Utilities

```python
def sks_to_minutes(sks):
    """Convert SKS to duration in minutes"""
    mapping = {2: 90, 3: 135}
    return mapping.get(sks, 0)

def time_to_minutes(time_str):
    """Convert HH:MM to minutes since 00:00"""
    h, m = map(int, time_str.split(':'))
    return h * 60 + m

def minutes_to_time(total_minutes):
    """Convert minutes to HH:MM format"""
    h = total_minutes // 60
    m = total_minutes % 60
    return f"{h:02d}:{m:02d}"
```

### Data Aggregation

```python
def get_usage_statistics(schedule):
    """Calculate resource usage statistics"""
    return {
        'room_usage': count_usage(schedule, 'ruangan_id'),
        'lecturer_usage': count_usage(schedule, 'dosen_id'),
        'day_distribution': count_usage(schedule, 'hari'),
        'time_slot_usage': count_time_slot_usage(schedule)
    }
```

---

## Dataset Examples

### Sample Dataset (Minimal)

```json
{
  "dosen": [
    {"id": 1, "nama": "Dr. Ahmad", "bidang_keahlian": "AI", "email": "ahmad@univ.edu"}
  ],
  "matakuliah": [
    {"id": 1, "nama": "Algoritma", "semester": 2, "sks": 3, "dosen_id": 1, "jumlah_mahasiswa": 25}
  ],
  "ruangan": [
    {"id": 1, "nama": "Lab A", "kapasitas": 30}
  ],
  "slot_waktu": [
    {"hari": "Senin", "jam_mulai": "08:00", "jam_selesai": "12:00"}
  ]
}
```

### Large Dataset Characteristics

Untuk dataset besar (production):
- **Dosen**: 50-200 entries
- **Mata Kuliah**: 200-1000 entries  
- **Ruangan**: 20-100 entries
- **Slot Waktu**: 6-7 hari × multiple time blocks

---

## Performance Considerations

### Data Loading Optimization

```python
# Lazy loading untuk dataset besar
def load_dataset_lazy(filename):
    with open(filename, 'r') as f:
        data = json.load(f)
    
    # Create indexes for fast lookup
    data['_indexes'] = {
        'dosen_by_id': {d['id']: d for d in data['dosen']},
        'ruangan_by_id': {r['id']: r for r in data['ruangan']},
        'mk_by_dosen': defaultdict(list)
    }
    
    for mk in data['matakuliah']:
        data['_indexes']['mk_by_dosen'][mk['dosen_id']].append(mk)
    
    return data
```

### Memory Management

- Use generators untuk large datasets
- Cleanup intermediate data structures
- Efficient data types (int vs string IDs)

---

[← Algorithms](03-algorithms.md) | [Lanjut ke API Documentation →](05-api-documentation.md)